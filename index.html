<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PT 배틀타워 싱글 조언봇 (21+)</title>

  <link rel="stylesheet" href="./style.css" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <meta name="theme-color" content="#0b1220" />
</head>

<body>
  <header class="top">
    <div class="wrap">
      <h1>PT 배틀타워 싱글 조언봇 (21+)</h1>
      <p class="sub">내 파티 입력/검증 → 상대 입력 → 추천행동/기술/이유 즉시 출력</p>
    </div>
  </header>

  <main class="wrap">
    <!-- DB -->
    <section class="card">
      <h2>DB 로드</h2>
      <div class="row">
        <div class="col">
          <label class="label">DB 선택</label>
          <select id="dbSelect" class="input">
            <!-- 권장: repo에 data/bt_group2_ko.json 넣기 -->
            <option value="./data/bt_group2_ko.json">실DB(Group2 전체, build_db.py로 생성)</option>
            <option value="./data/sample_group2_ko.json">샘플(Group2 일부)</option>

            <!-- (호환) 혹시 루트에 파일 두는 경우 -->
            <option value="./bt_group2_ko.json">실DB(루트에 있는 bt_group2_ko.json)</option>
          </select>
        </div>
        <div class="col end">
          <button id="btnLoadDb" class="btn">불러오기</button>
        </div>
      </div>
      <div class="status" id="dbStatus">DB 미로드</div>
      <div class="note">
        참고: Group2는 Platinum/HGSS 배틀프런티어 시설에서 NPC가 쓰는 세트 목록 기반입니다.
      </div>
    </section>

    <!-- PARTY MANAGER -->
    <section class="card">
      <h2>내 파티 (수정 가능 + 검증)</h2>

      <div class="row">
        <div class="col">
          <label class="label">파티 이름(자동 생성됨)</label>
          <input id="partyName" class="input" placeholder="예: 스이-크레-히드" />
          <div class="help" id="partyNameHelp"></div>
        </div>

        <div class="col">
          <label class="label">저장된 파티</label>
          <select id="partySelect" class="input"></select>
          <div class="help">파티는 삭제 전까지 계속 저장됩니다(localStorage).</div>
        </div>

        <div class="col end">
          <label class="label">&nbsp;</label>
          <div class="btnRow">
            <button id="btnSaveParty" class="btn">파티 저장/업데이트</button>
            <button id="btnLoadParty" class="btn secondary">파티 불러오기</button>
            <button id="btnDeleteParty" class="btn danger">파티 삭제</button>
          </div>
        </div>
      </div>

      <hr class="sep"/>

      <div class="grid3">
        <!-- Member 1 -->
        <div class="panel">
          <h3>1) 내 포켓몬</h3>

          <div class="field">
            <label class="label">포켓몬(한글)</label>
            <input id="m1_name" class="input" list="pokemonList" placeholder="예: 스이쿤" />
            <div class="help" id="m1_name_help"></div>
          </div>

          <div class="row">
            <div class="col">
              <div class="field">
                <label class="label">타입1(자동/수동)</label>
                <select id="m1_t1" class="input"></select>
                <div class="help" id="m1_t1_help"></div>
              </div>
            </div>
            <div class="col">
              <div class="field">
                <label class="label">타입2(선택)</label>
                <select id="m1_t2" class="input"></select>
                <div class="help" id="m1_t2_help"></div>
              </div>
            </div>
          </div>

          <div class="field">
            <label class="label">지닌물건</label>
            <input id="m1_item" class="input" list="itemList" placeholder="예: 먹다남은음식" />
            <div class="help" id="m1_item_help"></div>
          </div>

          <div class="field">
            <label class="label">기술 1</label>
            <input id="m1_mv1" class="input" list="moveList" placeholder="예: 파도타기" />
            <div class="help" id="m1_mv1_help"></div>
          </div>
          <div class="field">
            <label class="label">기술 2</label>
            <input id="m1_mv2" class="input" list="moveList" placeholder="예: 냉동빔" />
            <div class="help" id="m1_mv2_help"></div>
          </div>
          <div class="field">
            <label class="label">기술 3</label>
            <input id="m1_mv3" class="input" list="moveList" placeholder="예: 10만볼트" />
            <div class="help" id="m1_mv3_help"></div>
          </div>
          <div class="field">
            <label class="label">기술 4</label>
            <input id="m1_mv4" class="input" list="moveList" placeholder="예: 잠자기" />
            <div class="help" id="m1_mv4_help"></div>
          </div>
        </div>

        <!-- Member 2 -->
        <div class="panel">
          <h3>2) 내 포켓몬</h3>

          <div class="field">
            <label class="label">포켓몬(한글)</label>
            <input id="m2_name" class="input" list="pokemonList" placeholder="예: 한카리아스" />
            <div class="help" id="m2_name_help"></div>
          </div>

          <div class="row">
            <div class="col">
              <div class="field">
                <label class="label">타입1(자동/수동)</label>
                <select id="m2_t1" class="input"></select>
                <div class="help" id="m2_t1_help"></div>
              </div>
            </div>
            <div class="col">
              <div class="field">
                <label class="label">타입2(선택)</label>
                <select id="m2_t2" class="input"></select>
                <div class="help" id="m2_t2_help"></div>
              </div>
            </div>
          </div>

          <div class="field">
            <label class="label">지닌물건</label>
            <input id="m2_item" class="input" list="itemList" placeholder="예: 리샘열매" />
            <div class="help" id="m2_item_help"></div>
          </div>

          <div class="field"><label class="label">기술 1</label><input id="m2_mv1" class="input" list="moveList" placeholder="예: 지진" /><div class="help" id="m2_mv1_help"></div></div>
          <div class="field"><label class="label">기술 2</label><input id="m2_mv2" class="input" list="moveList" placeholder="예: 역린" /><div class="help" id="m2_mv2_help"></div></div>
          <div class="field"><label class="label">기술 3</label><input id="m2_mv3" class="input" list="moveList" placeholder="예: 맹독" /><div class="help" id="m2_mv3_help"></div></div>
          <div class="field"><label class="label">기술 4</label><input id="m2_mv4" class="input" list="moveList" placeholder="예: 불꽃엄니" /><div class="help" id="m2_mv4_help"></div></div>
        </div>

        <!-- Member 3 -->
        <div class="panel">
          <h3>3) 내 포켓몬</h3>

          <div class="field">
            <label class="label">포켓몬(한글)</label>
            <input id="m3_name" class="input" list="pokemonList" placeholder="예: 메타그로스" />
            <div class="help" id="m3_name_help"></div>
          </div>

          <div class="row">
            <div class="col">
              <div class="field">
                <label class="label">타입1(자동/수동)</label>
                <select id="m3_t1" class="input"></select>
                <div class="help" id="m3_t1_help"></div>
              </div>
            </div>
            <div class="col">
              <div class="field">
                <label class="label">타입2(선택)</label>
                <select id="m3_t2" class="input"></select>
                <div class="help" id="m3_t2_help"></div>
              </div>
            </div>
          </div>

          <div class="field">
            <label class="label">지닌물건</label>
            <input id="m3_item" class="input" list="itemList" placeholder="예: 생명의구슬" />
            <div class="help" id="m3_item_help"></div>
          </div>

          <div class="field"><label class="label">기술 1</label><input id="m3_mv1" class="input" list="moveList" placeholder="예: 칼춤" /><div class="help" id="m3_mv1_help"></div></div>
          <div class="field"><label class="label">기술 2</label><input id="m3_mv2" class="input" list="moveList" placeholder="예: 불릿펀치" /><div class="help" id="m3_mv2_help"></div></div>
          <div class="field"><label class="label">기술 3</label><input id="m3_mv3" class="input" list="moveList" placeholder="예: 코멧펀치" /><div class="help" id="m3_mv3_help"></div></div>
          <div class="field"><label class="label">기술 4</label><input id="m3_mv4" class="input" list="moveList" placeholder="예: 대폭발" /><div class="help" id="m3_mv4_help"></div></div>
        </div>
      </div>

      <div class="row mt">
        <div class="col">
          <button id="btnValidateParty" class="btn">파티 입력완료(검증)</button>
          <span class="statusInline" id="partyStatus">검증 전</span>
        </div>
        <div class="col end">
          <label class="label">현재 내 선봉(활성)</label>
          <select id="activeSelect" class="input"></select>
        </div>
      </div>

      <datalist id="pokemonList"></datalist>
      <datalist id="moveList"></datalist>
      <datalist id="itemList"></datalist>

      <div class="note">
        ※ DB에 없는 포켓몬/기술/아이템은 추천 정확도를 크게 떨어뜨리므로, 검증을 통과해야 추천이 실행됩니다.
      </div>
    </section>

    <!-- OPPONENT -->
    <section class="card">
      <h2>상대 입력 → 추천행동</h2>

      <div class="field">
        <label class="label">상대 포켓몬(한글명 검색)</label>
        <input id="oppName" class="input" list="pokemonList" placeholder="예: 크레세리아, 라프라스, 팬텀(=고스트 전기X…)" />
        <div class="help" id="oppNameHelp"></div>
      </div>

      <details class="details">
        <summary>상대 관측 정보(선택, 알면 정확도↑)</summary>
        <div class="row mt">
          <div class="col">
            <label class="label">상대 지닌물건(관측)</label>
            <input id="oppItemObs" class="input" list="itemList" placeholder="예: 먹다남은음식" />
          </div>
          <div class="col">
            <label class="label">상대 기술(관측)</label>
            <input id="oppMoveObs" class="input" list="moveList" placeholder="예: 전기자석파" />
          </div>
        </div>
      </details>

      <div class="row mt">
        <div class="col">
          <button id="btnRecommend" class="btn">추천행동 계산</button>
          <span class="statusInline" id="recStatus"></span>
        </div>
      </div>

      <div id="resultBox" class="result"></div>

      <div class="footnote">
        주의: 이 앱은 “세트 DB(기술/아이템/EV 등)” 기반 룰 엔진입니다. 실제 실전은 급소/명중/턴 선택 등 변수가 있어 100% 보장은 불가능합니다.
      </div>
    </section>
  </main>

  <script src="./app.js" defer></script>
</body>
</html>
